
aspect LookupTypeExt {
    public void Program.changeTypeMap(String oldfullName, String newfullName, TypeDecl td){
        TypeDecl removedTd  = sourceTypeMap.remove(oldfullName);

        if( removedTd != null && removedTd != td)
            throw new RefactoringException("wrong type changed");

        registerType(newfullName, td);
    }

    public void Program.registerType(String fullName, TypeDecl td){
        sourceTypeMap.put(fullName, td);
    }
}